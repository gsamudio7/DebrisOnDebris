---
title: "Space Debris Collision Risk Analysis"
subtitle: |
  | U.S. Army FA49 Qualification Course Capstone Project
  | `r format(Sys.time(), '%B %d %Y')`
author:
  "[MAJ J.D. Caddell<br>
    MAJ Charles Gallagher<br>
    MAJ Ben Halle\n<br>
    MAJ Tim Justicz<br>
    MAJ Gabe Samudio](https://github.com/gsamudio7/DebrisOnDebris)"
output:
  html_document:
    css: assets/css/html_report.css
    highlight: haddock
    self_contained: yes
    toc: yes
    toc_float: yes
    toc_depth: 3
---



<style>

#TOC {
  margin-top: 20px;
  background: url("https://ewscripps.brightspotcdn.com/dims4/default/9d34d32/2147483647/strip/true/crop/1280x720+0+0/resize/1280x720!/quality/90/?url=http%3A%2F%2Fewscripps-brightspot.s3.amazonaws.com%2F42%2Fb3%2Ff10c7ff1498880ea9768df26cf47%2Fus-space-command.jpg");
  background-size: contain;
  padding-top: 170px !important;
  background-repeat: no-repeat;
  border: None;
}

</style>
<center>
<img src="assets/MIT-Orbit-Debris_0.jpeg" width="80%"/> 
<br>
<b>Figure 1:</b> Picture from [MIT news website](https://news.mit.edu/2017/space-junk-shards-teflon-0619) depicting the large volume of space debris orbiting the Earth at ~17,500 mph.
</center>
<br>
<br>

```{r setUp, include=FALSE}
knitr::opts_chunk$set(
  cache=FALSE,
  message=FALSE,
  warning=FALSE,
  fig.align="center",
  class.source="chunk",
  out.width="100%",
  fig.retina = 3
)

library(data.table)
library(dplyr)
library(plotly)
library(RColorBrewer)
library(formattable)
options(scipen=99)
```

# Executive Summary
- Charged with informing the process to develop a debris on debris collision warning threshold to mitigate future collision risk and limit false alarms.
- The study has focused on the following parameters:
    - Fragment size of at least 1.
    - Five days to time of closest approach (TCA).
    - Concern Events terminology defined as $\text{Collision Probability} >= 1\text{e-}5$ within a day to TCA.
- Study progress:
    - We can visualize the missed concern event and false alarm risk space.
    - We have developed an application to explore various warning thresholds.

# Problem Formulation
- <b>Problem Statement:</b> Under what circumstances should debris-on-debris collision warnings be used?
    - What probability of collision should be used as a surrogate for an actual event of concern?
    - What probability of collision should trigger a warning at five days to TCA?
    - How well can we do in warning for events occurring in the future?

- <b>Mission Statement:</b> Recommend debris collision notification thresholds and develop a mechanism to explore the notification decision space to assess risk of debris-on-debris collisions in space. 

# Exploratory Data Analysis {.tabset}

- <b>Questions:</b>
    - How is the Collision Probability distributed?
    - How does the rate of new concern events change over time?
    - How does the Collision Probability change over time?
    
- <b>Data Preparation:</b>
    - Summarize by each event to show the Collision Probability for each fragment size at the last recorded time, if that time is within a day of TCA.

    - Summarize by each event to show the Collision Probability for each fragment size at the last recorded time, for each binned days to TCA.
    
<br>

## Collision Probability Density
We need to find a range of values to appropriately label events of concern.

How many events have $\text{Collision Probability} = 0$ when $\text{days to TCA} < 1$?

<center>
```{r EDA1, echo=FALSE}

#load("data/concernData.RData")

# How many are 0?
load("products/zeroCount.RData")
zeroCount %>% formattable(align="l") %>% as.htmlwidget(width=250)#

```
</center>

```{r eda_plot1, echo=FALSE, fig.cap="<b>Figure 2: </b>Collision Probability within One Day of TCA"}
load("products/Pc_at_1_day.RData")
Pc_at_1_day
```

We use,
<br>
<center>
$\text{Collision Probabilty} >= 1\text{e-}5 \text{ and days to TCA} < 1 \text{ day,}$ 
</center>
<br>
as a surrogate to label a concern event. 

## Concern Event Frequency 
How is our visibility of concern events limited?

How many Concern Events if the threshold is $1\text{e-}5$?

<center>
```{r EDA2, echo=FALSE}

load("products/concernCount.RData")
concernCount %>% formattable(align="l") %>% as.htmlwidget(width=250)#

```
</center>

We focus our initial analysis on concern events with fragment size of $>= 1$ fragment. Future methodology will include events with higher fragment sizes.

```{r eda_plot2, echo=FALSE, fig.cap="<b>Figure 3: </b>Concern Event Count over Time"}
load("products/newConcernSummary_plot.RData")
newConcernSummary_plot
```
<b>Conclusions:</b>

- At $5 \text{ days to TCA}$ the number of new concern events drastically increases.
- We will only have visibility of about $50%$ of concern events at $5 \text{ days to TCA}$.
- There is an advantage to a warning time interval within 5 days.

## Collision Probability Variability
- Does the $\text{Collision Probability}$ increase as we aproach $\text{TCA}$?
- Should we expect to have a lower warning threshold at $5 \text{ days to TCA}$

```{r eda_plot3, echo=FALSE, fig.cap="<b>Figure 4: </b>Collision Probability as TCA Varies"}
load("products/Pc_by_TCA_plot.RData")
Pc_by_TCA_plot
```
<b>Conclusions:</b>

- The variability expands slightly, but there is not overwhelming evidence of an increase in the $\text{Collision Probabilty}$.
- We consider the following range for $\text{Collision Probability}$ warning thresholds:

<br>
<center>
$1.94\text{e-}22 <= Pc\_warn <= 1\text{e-}5$,
</center>
<br>
where $Pc\_warn$ is the $\text{Collision Probability}$ that triggers a warning.



# Risk Tradespace
We need to evaluate warning thresholds by examining the trade space between risk aversion and tolerance.

We have the following working definitions:

<br>
<center>
$\text{Concern Event} := \text{Collision Probability} <= 1\text{e-}5 \text{ and days to TCA < 1 day}$
<br>

$\text{FN} := \text{Number of Concern Events that did not trigger a warning at 5 days to TCA}$
<br>

$\text{FP} := \text{Number of false alarms, where warned events at 5 days to TCA did not become Concern Events}$
<br>

</center>

<br>

```{r eda_plot4, echo=FALSE, fig.cap="<b>Figure 5: </b>Confusion Rates at Five Days to TCA\nand Concern Prop = 1e-5",fig.width=4, fig.show='hold'}
load("products/concernRates_plot.RData")
concernRates_plot
```

Hovering over the plot, we see the that the warning threshold decreases as FN decreases and as FP increases. In this case, the more severe mistake is FN (not warning for a concern event), which is our Type II error, and the FP (false alarm, Type I error) has much lower rates. The FP rates are so low because of the high number of events with Collision Probabilities falling below $1\text{e-}5$ within one day to TCA.

We recommend this chart to inform warning thresholds for five days to TCA, when a concern event is defined above.

# Way Forward 
- Finalize warning threshold point estimate formulation.
- Employ Monte Carlo method to explore the variability of the point estimate, and deliver a $95% \text{bootstrap confidence inverval}$ for warning threshold at five days to TCA.
- Repeat this methodology for 4, 3, 2 days to TCA.
- Iterate on the R Shiny Application based on client feedback.