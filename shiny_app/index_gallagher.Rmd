---
title: "Space conjunction analysis in support of USSPACECOM"
output: flexdashboard::flex_dashboard
runtime: shiny
---




```{r global, include=FALSE}
# load data in 'global' chunk so it can be shared by all users of the dashboard
library(datasets)
library(flexdashboard)
data(faithful)
```

Column {.sidebar} {data-width=250}
-----------------------------------------------------------------------

Space conjunction analysis in support of USSPACECOM. Choose the selected parameters.

```{r}
# Number of Fragments
selectInput("NumFrags", label = "Number of fragments:",
            choices = c(1, 10, 100, 1000 ,10000), selected = 100)

# Days to TCA 
sliderInput("DaysTCA", label = "Days to TCA",
            min = 1, max = 10, value = 1, step = 1)

#threshold_Pc

sliderInput("PcThresh", label = "Pc Threshold",
            min = 1e-10, max = 1e-2,, value = 1e-5, step =1e-4)

textInput("inputId", "Concern Category A", 1e-3)
textInput("inputId", "Concern Category B", 1e-4)
textInput("inputId", "Concern Category C", 1e-5)

```

Column
-----------------------------------------------------------------------
### Concern Category A 

```{r}
library(dplyr)
library(tidymodels)
data("hpc_cv")

# The confusion matrix from a single assessment set (i.e. fold)
cm <- hpc_cv %>%
  filter(Resample == "Fold01") %>%
  conf_mat(obs, pred)

library(purrr)
library(tidyr)

cells_per_resample <- hpc_cv %>%
  group_by(Resample) %>%
  conf_mat(obs, pred) %>%
  mutate(tidied = map(conf_mat, tidy)) %>%
  unnest(tidied)

# Get the totals per resample
counts_per_resample <- hpc_cv %>%
  group_by(Resample) %>%
  summarize(total = n()) %>%
  left_join(cells_per_resample, by = "Resample") %>%
  # Compute the proportions
  mutate(prop = value/total) %>%
  group_by(name) %>%
  # Average
  summarize(prop = mean(prop))


# Now reshape these into a matrix
mean_cmat <- matrix(counts_per_resample$prop, byrow = TRUE, ncol = 4)
rownames(mean_cmat) <- levels(hpc_cv$obs)
colnames(mean_cmat) <- levels(hpc_cv$obs)



# The confusion matrix can quickly be visualized using autoplot()
library(ggplot2)

autoplot(cm, type = "heatmap")


```
    
### Concern Category B 

```{r}
autoplot(cm, type = "heatmap")
```

### Concern Category C 

```{r}
autoplot(cm, type = "heatmap")
```